#---------------------------------#
#      general configuration      #
#---------------------------------#

# version format
version: 2.0b3.{build}

# branches to build
branches:
  # whitelist
  only:
    - master
    - devops

  # blacklist
  except:
    - gh-pages

# Do not build on tags (GitHub, Bitbucket, GitLab, Gitea)
skip_tags: true

# Do not build feature branch with open Pull Requests
skip_branch_with_pr: true

# Maximum number of concurrent jobs for the project
max_jobs: 1

#---------------------------------#
#    environment configuration    #
#---------------------------------#

# Build worker image (VM template)
image: macos-catalina

# scripts that are called at very beginning, before repo cloning
init:
  - git config --global core.autocrlf input

# clone directory
clone_folder: c:\projects\RIDE

# fetch repository as zip archive
shallow_clone: false                 # default is "false"

# set clone depth
clone_depth: 5                      # clone entire repository history if not defined

# this is how to allow failing jobs in the matrix
matrix:
  fast_finish: false     # set this flag to immediately finish build once one of the jobs fails.
  allow_failures:
    - platform: x64
      configuration: Release

environment:
  matrix:

    - APPVEYOR_BUILD_WORKER_IMAGE: macOS
      TOXENV: py39

build: off

# scripts that run after cloning repository
install:
  - brew install python@3.9
  - python3.9 -m pip install https://files.pythonhosted.org/packages/2c/a8/7027e8ca3ba20dc2ed2acd556e31941cb44097ab87d6f81d646a79de4eab/wxPython-4.1.1-cp39-cp39-macosx_10_10_x86_64.whl
  - python3.9 -m pip install -r requirements-dev.txt
  - python3.9 -m pip install -r requirements.txt
  - python3.9 -m pip install .


#---------------------------------#
#       tests configuration       #
#---------------------------------#

# to run your custom scripts instead of automatic tests
test_script:
  - invoke test-ci
